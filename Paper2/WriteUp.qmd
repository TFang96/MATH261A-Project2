---
title: "Land Use Efficiency: How Unit Count and Stories Impact Lot Value"
author: "Ziheng (Tony) Fang"
thanks: "Project GitHub Repository: https://github.com/TFang96/MATH261A-Project2"
format: pdf
editor: visual
bibliography: references.bib
---

## Abstract

For properties on the real estate market, one may expect that the larger the lot size, the larger the market value of the property. In the real world, is that true? Would the relationship between lot size and market value instead be impacted by the total number of units the property contains and the number of stories the property hosts? Some in the real estate industry would wonder if having more residential units or a higher building would increase or decrease the value of the land the property is built on. Data regarding total assessed value of different residential properties was studied from real estate data provided by the Assessor's Office in San Francisco. Methods utilized included building a regression model, studying the interaction effects, and running a hypothesis test for the interaction effects.

## Introduction

In many urban areas across the country, the population is extremely dense, making land among one of the most scarcest and valuable resources for real estate developers. In the eyes of a developer, how efficiently land is utilized, whether it's having multiple units in one property or multiple stories in a unit, significantly impacts the city's housing supply. In cities like San Francisco, where housing is limited and prices are up, land use is a significant problem that city leaders want to address. On top of supply, understanding how lot area would interact with the number of units inside a property or the number of stories a unit has can provide additional insights on how efficient land use can actually have an impact on property value in the eyes of a potential homeowner. From this our hypothesis test in this study, we can also see that contrary to the belief that increases in lot area would increase the assessed value, the two variables are actually not related.

Prior research often examined how the prices of property are predicted by direct predictors such as the lot area, room count, bedroom count, etc. However, these studies very rarely address how variables regarding efficient land use, such has having multiple units in a building and multiple stories in a unit could impact how our predictors affect property value. In reality, many of these variables are interdependent whereas while we could utilize land more efficiently by having a residential unit with multiple floors and having multiple residential units in one building, in the eyes of a property owner, the value per unit of lot size may also change significantly.

This paper uses data from the San Francisco Assessor-Recorder office to see how property values are impacted not only by the lot area, but by how the number of units inside a property and the number of stories per unit impacts how lot area affects property values. A multiple linear regression model was utilized to examine both the direct effect of lot area on the assessed value and how the unit count and story count affects the impact lot area has on the assessed value through the interaction effect.

By identifying how vertical expansion and having multiple units inside a building affects how a unit change in lot area affects property value, this paper provides additional insight for developers when considering land use. Insights from this analysis can help developers and policymakers better understand trade-offs when it comes to land use efficiency and real estate value.

The Data section gives further details on data that was utilized for this paper. Details on the statistical methods utilized are listed in the Methods section. The Results section includes our statistical findings. The conclusion we drew can be found in the Discussion section.

## Data

The data set used for this paper, Assessor Historical Secured Property Tax Rolls [@SFRealEstateData], provides details such as the assessed values, lot area, number of units, number of stories, and more for properties within the city of San Francisco since 2016. The data was compiled by the city assessor's office. We have a total of 3.72M observations in the original dataset where each observation represents a real estate property. Variables that used for the response variable in our study included Assessed.Fixtures.Value, Assessed.Improvement.Value, Assessed.Land.Value, and Assessed.Personal.Property.Value, which were summed up into the AssessedValue. Variables used as our predictor variables included Lot.Area, Number.of.Units, and Number.of.Stores. To allow numerical computations, all commas were removed. Since clients look for very different features when on the market for residential and commercial properties, we only kept data on single family residential and multiple family residential units.

```{r}
#| echo: false
#| message: false
#| warning: false
#| tbl-cap: "Summary statistics for assessed property values, unit count within each building and story count within a building."
library(stringr)
library(dplyr)   # for %>% and summarise()
library(knitr)   # for kable() to format tables

housing_data <- read.csv("Assessor_Historical_Secured_Property_Tax_Rolls_20251122.csv")

#Convert units to numeric
housing_data$Number.of.Units <- as.numeric(housing_data$Number.of.Units)

# Remove commas or symbols, then convert to numeric
housing_data$Assessed.Fixtures.Value <- as.numeric(gsub("[$,]", "", housing_data$Assessed.Fixtures.Value))
housing_data$Assessed.Improvement.Value <- as.numeric(gsub("[$,]", "", housing_data$Assessed.Improvement.Value))
housing_data$Assessed.Land.Value <- as.numeric(gsub("[$,]", "", housing_data$Assessed.Land.Value))
housing_data$Assessed.Personal.Property.Value <- as.numeric(gsub("[$,]", "", housing_data$Assessed.Personal.Property.Value))

housing_data$AssessedValue <- rowSums(housing_data[, c("Assessed.Fixtures.Value", 
                                                       "Assessed.Improvement.Value", 
                                                       "Assessed.Land.Value", 
                                                       "Assessed.Personal.Property.Value")],
                                      na.rm = TRUE)

#filter only useful data


#convert into numeric
housing_data$Lot.Area <- housing_data$Lot.Area |>
  as.character() |>                # ensure it's character, not factor
  str_trim() |>                    # remove leading/trailing spaces
  str_replace_all("[^0-9.]", "") |> # remove everything that's not a digit or dot
  as.numeric()

housing_data$Number.of.Bedrooms <- housing_data$Number.of.Bedrooms |>
  as.character() |>
  str_trim() |>
  str_replace_all("[^0-9.]", "") |>
  as.numeric()

housing_data$Number.of.Rooms <- housing_data$Number.of.Rooms |>
  as.character() |>
  str_trim() |>
  str_replace_all("[^0-9.]", "") |>
  as.numeric()

# we only want residential
housing_data <- subset(housing_data, Use.Code %in% c("MRES", "SRES"))

#drop rows with missing data
housing_data <- subset(housing_data, Lot.Area > 0 & !is.na(Lot.Area) & !is.na(Number.of.Units) & !is.na(Number.of.Stories) & !is.na(Number.of.Bedrooms) & !is.na(Number.of.Rooms))

#create summary statistics
housing_data %>%
  summarise(
    Mean_Assessed_Value   = mean(AssessedValue, na.rm = TRUE),
    Assessed_Value_SD     = sd(AssessedValue, na.rm = TRUE),
    MinAssessedValue    = min(AssessedValue, na.rm = TRUE),
    MaxAssessedValue    = max(AssessedValue, na.rm = TRUE),
    Mean_LotArea = mean(Lot.Area, na.rm = TRUE),
    LotArea_SD   = sd(Lot.Area, na.rm = TRUE),
    Min_LotArea  = min(Lot.Area, na.rm = TRUE),
    Max_LotArea  = max(Lot.Area, na.rm = TRUE),
    Mean_NumberOfUnits = mean(Number.of.Units, na.rm= TRUE),
    NumberOfUnits_SD = sd(Number.of.Units, na.rm=TRUE),
    Min_NumberOfUnits = min(Number.of.Units, na.rm=TRUE),
    Max_NumberOfUnits = max(Number.of.Units, na.rm=TRUE),
    Mean_NumberOfStories = mean(Number.of.Stories, na.rm=TRUE),
    NumberOfStories_SD = sd(Number.of.Stories, na.rm=TRUE),
    Min_NumberOfStories = min(Number.of.Stories, na.rm=TRUE),
    Max_NumberOfStores = max(Number.of.Stories, na.rm=TRUE)
  ) %>%
  t() %>%
  kable(col.names = c("Value"))

```

```{r}

```

## Methods

## Results

## Discussion

## References
